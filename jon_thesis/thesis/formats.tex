%%%%%%%%%%%%%%%%%%%%%%%%%
% Page Size Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%

%\setlength{\parskip}{3pt}
%\setlength{\parskip}{\baselineskip}
%\addtolength{\parskip}{0.3\baselineskip}
\addtolength{\parskip}{12pt} % gap between paragraphs
\setlength{\parindent}{0pt} % Disable paragraph indent

%%%%%%%%%%%%%%%%%%%%%%%%%
% What a large floater!
%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\renewcommand{\dbltopfraction}{.66}
\renewcommand{\dblfloatpagefraction}{.66}
\setcounter{topnumber}{9}
\setcounter{bottomnumber}{9}
\setcounter{totalnumber}{20}
\setcounter{dbltopnumber}{9}

%%%%%%%%%%%%%%%%%%%%%%%%%
% Text Master Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%

% List of Abreviations
% Adapted from http://www.iam.ubc.ca/~newbury/tex/thesis.html
\def\abbrevsec  #1     {\\ \multicolumn{2}{l}{\textbf{\emph{#1}}} \\}
\def\addabbrev  #1#2   {#1 & \multicolumn{2}{l}{\parbox{4.65in}{#2 \dotfill}}  \\ }
\def\addabbrevd  #1#2#3   {#1 & #2 & \hspace{-1.35cm}\parbox{3.77in}{#3 \dotfill} \\ }
%\def\addsymabbrev #1: #2{$#1$\> \parbox{5in}{#2 \dotfill}

% TOC and Section - NOTE the default is W.X.Y levels - we want W.X.Y.Z.
\setcounter{tocdepth}{3}    % Table of Contents will be 3 sections deep.
\setcounter{secnumdepth}{3} % Section numbering will go as deep as \subsubsection

% Have a 'Table of Contents' section rather than 'Contents'
\renewcommand{\contentsname}{Table of Contents} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% My own jBox
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newenvironment{jbox*}[2]
%{
%    \vspace{5pt}
%    \textbf{#1}
%    \vspace{-\baselineskip}\vspace{-5pt}
%    \begin{center}
%    \begin{tabular}{p{#2\textwidth}}
%}
%{
%    \end{tabular}
%    \end{center}\vspace{-15pt}
%}

%\newenvironment{jbox}[1]
%{
%    \vspace{5pt}
%    \textbf{#1}
%    \vspace{-\baselineskip}\vspace{-5pt}
%    \begin{center}
%    \begin{tabular}{p{0.9\textwidth}}
%}
%{
%    \end{tabular}
%    \end{center}\vspace{-15pt}
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Special Itemise Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Move the enumeration up slightly and reduce the default separation
\newcommand\isep{\vspace{-0.3cm}\setlength{\itemsep}{2pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Special Table Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Rule separations
\aboverulesep=6pt
\belowrulesep=6pt
\abovetopsep=18pt
\belowbottomsep=8pt

% Allows for a bold row style using e.g.:
%\begin{tabular}{+c^c^c}
%\toprule 
%\rowstyle{\bfseries} Experimental & Proteins & Nucleic \\
\newcolumntype {+}{ >{\global\let\currentrowstyle\relax}}
\newcolumntype {^}{ >{\currentrowstyle}}
\newcommand {\rowstyle }[1]{\gdef\currentrowstyle{#1}#1\ignorespaces}

%%%%%%%%%%%%%%%%%%%%%
% General Formatting
%%%%%%%%%%%%%%%%%%%%%

% We can now use \lstset{language=Python}
% and \lstset{language=CSharp}

% Code snippet formatting
\definecolor{lightBackgroundColour}{rgb}{0.90,0.90,0.90}
\definecolor{stringColour}{rgb}{0.0,0.6,0.6} 
\definecolor{commentColour}{rgb}{0.9,0.0,0.0} 
\definecolor{shadowColour}{rgb}{0.6,0.6,0.6}
\definecolor{black}{rgb}{0.0,0.0,0.0} 

\lstset{backgroundcolor=\color{lightBackgroundColour},rulecolor=\color{black}}
\lstset{frame=tb}
\lstset{basicstyle=\tiny\singlespace\sffamily}
\lstset{keywordstyle=\color{blue}}%\bfseries}
\lstset{stringstyle=\color{stringColour}}%\bfseries}
\lstset{commentstyle=\color{commentColour}}
\lstset{xleftmargin=8mm,xrightmargin=8mm}
\lstset{framextopmargin=2mm,framexbottommargin=2mm}
\lstset{framexleftmargin=2mm,framexrightmargin=2mm}
\lstset{breaklines=false}
\lstset{showstringspaces=false}
\lstset{captionpos=b}
\lstset{floatplacement=htpb}
\lstset{aboveskip=0.4cm}
\lstset{belowskip=0.3cm}
\lstset{frame=shadowbox,rulesepcolor=\color{shadowColour}}
%\lstset{numbers=left}

%%%%%%%%%%%%
% C# Source
%%%%%%%%%%%%
%
\lstdefinelanguage{CSharp}
{
 morecomment = [l]{//}, 
 morecomment = [l]{///},
 morecomment = [s]{/*}{*/},
 morestring=[b]", 
 sensitive = true,
 morekeywords = {abstract,  event,  new,  struct,
   as,  explicit,  null,  switch,
   base,  extern,  object,  this,
   bool,  false,  operator,  throw,
   break,  finally,  out,  true,
   byte,  fixed,  override,  try,
   case,  float,  params,  typeof,
   catch,  for,  private,  uint,
   char,  foreach,  protected,  ulong,
   checked,  goto,  public,  unchecked,
   class,  if,  readonly,  unsafe,
   const,  implicit,  ref,  ushort,
   continue,  in,  return,  using,
   decimal,  int,  sbyte,  virtual,
   default,  interface,  sealed,  volatile,
   delegate,  internal,  short,  void,
   do,  is,  sizeof,  while,
   double,  lock,  stackalloc,   
   else,  long,  static,   
   enum,  namespace,  string}
}

\lstdefinelanguage{charmm}
{
 morecomment = [l]{!}, 
 morecomment = [l]{*},
 morestring=[b]", 
 sensitive = true,
 morekeywords = {open, close, unit, card, name, read, stop }
}

%%%%%%%%%%%%%%%%%%
% Fancy Header
%%%%%%%%%%%%%%%%%%

%\usepackage{fancyhdr}

%\pagestyle{fancy}
%\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
%\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}{}}
%\fancyhf{}
%\fancyhead[LE,RO]{\bfseries\thepage}
%\fancyhead[LO]{\bfseries\rightmark}
%\fancyhead[RE]{\bfseries\leftmark}
%\renewcommand{\headrulewidth}{0.5pt}
%\renewcommand{\footrulewidth}{0.0pt}
%\addtolength{\headheight}{2.5pt}                % 0.5pt
%\fancypagestyle{plain}{
%     \fancyhead{}
%     \renewcommand{\headrulewidth}{0pt}
%     }

